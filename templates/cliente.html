<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Examen UNI en Curso</title>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
    <style>
        :root { --primary: #7b1fa2; --danger: #ef4444; --success: #10b981; }
        body { font-family: sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; background: #f3f4f6; }
        
        /* Lado Izquierdo: El Examen */
        .examen-container { flex: 2; background: white; border-right: 2px solid #ddd; display: flex; flex-direction: column; }
        iframe { width: 100%; height: 100%; border: none; }

        /* Lado Derecho: Supervisi√≥n */
        .sidebar { flex: 1; display: flex; flex-direction: column; padding: 20px; align-items: center; overflow-y: auto; }
        .student-card { background: #f8fafc; padding: 15px; border-radius: 10px; width: 100%; margin-bottom: 20px; border-left: 5px solid var(--primary); }
        video { width: 100%; border-radius: 12px; transform: scaleX(-1); background: #000; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        .status-badge { padding: 10px 20px; border-radius: 50px; font-weight: bold; margin-top: 15px; font-size: 14px; }
        .status-ok { background: #d1fae5; color: var(--success); }
        .status-alert { background: #fee2e2; color: var(--danger); }
        
        .event-log { width: 100%; margin-top: 20px; background: white; border-radius: 10px; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .log-item { display: flex; justify-content: space-between; padding: 8px; border-bottom: 1px solid #eee; font-size: 12px; }
        .btn-fullscreen { background: var(--primary); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="examen-container">
        <iframe src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSGZrXzZlhQqE2TneLdkK3T92djLus-eOzK6w&s">
            Cargando examen...
        </iframe>
    </div>

    <div class="sidebar">
        <button class="btn-fullscreen" onclick="activarFullscreen()">‚¨ÜÔ∏è Activar Pantalla Completa</button>
        
        <div class="student-card">
            <p style="margin:0"><strong>Alumno:</strong> {{ nombre }}</p>
            <p style="margin:5px 0 0 0"><strong>Materia:</strong> {{ materia }}</p>
        </div>

        <video id="video-alumno" autoplay playsinline></video>
        <canvas id="canvas-oculto" style="display:none" width="640" height="480"></canvas>
        
        <div id="estado" class="status-badge status-ok">üü¢ Monitoreo Activo</div>

        <div class="event-log">
            <h4 style="margin:0 0 10px 0">Incidencias Detectadas</h4>
            <div id="lista-eventos"></div>
        </div>
    </div>

    <script>
        const DATOS_ALUMNO = {uid: "{{uid}}", nombre: "{{nombre}}", materia: "{{materia}}"};
    </script>
    <script src="/static/js/motor_ia.js"></script>
</body>
</html>
